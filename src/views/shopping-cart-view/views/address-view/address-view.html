<template>
	<require from="components/shop-dialog/shop-dialog"></require>
	<require from="components/address-field/address-field"></require>
	<require from="./address-view.css"></require>

	<div class="address-view">
		<mdc-layout-grid no-padding>
			<mdc-layout-grid-inner class="mb-3">
				<mdc-layout-grid-cell span="12">
					<h5 class="text-on-surface">
						Deine Adresse
					</h5>
					<h6 class="sub-title">
						Wohin soll es geschickt werden?
					</h6>
				</mdc-layout-grid-cell>
			</mdc-layout-grid-inner>
			<mdc-layout-grid-inner>
				<mdc-layout-grid-cell span="12">
					<mdc-layout-grid-inner>
						<mdc-layout-grid-cell
							if.bind="addresses.length > 0"
							repeat.for="address of addresses & signal:'addresses-updated'"
							span="6"
						>
							<mdc-card>
								<mdc-card-primary-action surface disable-ripple class="cursor-pointer">
									<mdc-form-field class="ps-2">
										<mdc-radio
											class="address-radio-button"
											disabled.bind="loading"
											model.bind="address"
											checked.two-way="selectedAddress"
											change.trigger="radioChanged(address.id)"
										></mdc-radio>
										<label class="w-100 p-2 cursor-pointer">
											<mdc-layout-grid-inner>
												<mdc-layout-grid-cell span="4"><span mdc-body2>Name:</span>
												</mdc-layout-grid-cell>
												<mdc-layout-grid-cell span="8">
													<span mdc-body2>${address.firstname} ${address.lastname}</span>
												</mdc-layout-grid-cell>
											</mdc-layout-grid-inner>
											<mdc-layout-grid-inner>
												<mdc-layout-grid-cell span="4"><span mdc-body2>Straße:</span>
												</mdc-layout-grid-cell>
												<mdc-layout-grid-cell span="8"><span mdc-body2>${address.street}</span>
												</mdc-layout-grid-cell>
											</mdc-layout-grid-inner>
											<mdc-layout-grid-inner>
												<mdc-layout-grid-cell span="4"><span mdc-body2>Stadt:</span>
												</mdc-layout-grid-cell>
												<mdc-layout-grid-cell span="8"><span mdc-body2>${address.city}</span>
												</mdc-layout-grid-cell>
											</mdc-layout-grid-inner>
											<mdc-layout-grid-inner>
												<mdc-layout-grid-cell span="4"><span mdc-body2>PLZ:</span>
												</mdc-layout-grid-cell>
												<mdc-layout-grid-cell span="8"><span mdc-body2>${address.zip}</span>
												</mdc-layout-grid-cell>
											</mdc-layout-grid-inner>
											<mdc-layout-grid-inner>
												<mdc-layout-grid-cell span="4"><span mdc-body2>Land:</span>
												</mdc-layout-grid-cell>
												<mdc-layout-grid-cell span="8"><span mdc-body2>${address.country}</span>
												</mdc-layout-grid-cell>
											</mdc-layout-grid-inner>
										</label>
									</mdc-form-field>
								</mdc-card-primary-action>
							</mdc-card>
						</mdc-layout-grid-cell>

						<mdc-layout-grid-cell else span="12" class="d-flex justify-content-center mt-4">
							<mdc-circular-progress size="50" stroke-width="5"></mdc-circular-progress>
						</mdc-layout-grid-cell>

					</mdc-layout-grid-inner>
				</mdc-layout-grid-cell>
				<mdc-layout-grid-cell>
					<button type="button" class="btn d-flex btn-sm fw-bold text-on-surface ps-0"
							data-bs-toggle="modal"
							data-bs-target="#address-dialog">
						Adresse hinzufügen
						<span class="material-icons-outlined ms-2">add</span>
					</button>
				</mdc-layout-grid-cell>
				<mdc-layout-grid-cell span="12">
					<div class="d-flex flex-row justify-content-between">
						<div class="d-flex justify-content-start">
							<a type="submit"
							   mdc-button
							   outlined
							   class="mdc-button--thick-outlined"
							   route-href="route: items"
							>
								<mdc-icon>shopping_cart</mdc-icon>
								Zurück
							</a>
						</div>
						<a type="submit"
						   mdc-button
						   unelevated
						   route-href="route: payment"
						   class="mdc-button--secondary"
						>

							<span mdc-button-label>Weiter</span>
							<mdc-icon>payments</mdc-icon>
						</a>
					</div>
				</mdc-layout-grid-cell>
			</mdc-layout-grid-inner>
		</mdc-layout-grid>
	</div>
	<shop-dialog id="address-dialog" aria-labelledby="address-dialog-label">
		<div slot="header">
			<h5 id="address-dialog-label">
				<mdc-layout-grid-inner class="mb-3">
					<h5 class="text-on-surface">
						Deine Adresse
					</h5>
					<h6 class="sub-title">
						Gib eine neue Adresse ein.
					</h6>
				</mdc-layout-grid-inner>
			</h5>
		</div>
		<div slot="body">
			<address-field class="border border-1"></address-field>
		</div>
		<div slot="footer">
			<span>
				<button type="submit" class="btn btn-sm btn-secondary border-primary d-flex">
					Neue Adresse hinzufügen und auswählen
				</button>
			</span>
		</div>
	</shop-dialog>

	<mdc-dialog view-model.ref="errorDialog">
		<mdc-dialog-title>
			Unbekannter Fehler
		</mdc-dialog-title>
		<mdc-dialog-content>
			Versuchen Sie es später nochmal!
		</mdc-dialog-content>
		<mdc-dialog-actions>
			<button
				mdc-button data-mdc-dialog-action="ok"
				data-mdc-dialog-button-default
				data-mdc-dialog-initial-focus
			>Ok</button>
		</mdc-dialog-actions>
	</mdc-dialog>
</template>
